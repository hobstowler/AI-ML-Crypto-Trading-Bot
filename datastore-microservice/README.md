# Datastore Microservice

This is a microservice for storing, retrieving and deleting training data and session activity data for the AI model.

---

## Data Model

### Model_Info

TBD

### SessionPage

Entity describing a trading session with various measures related to the trading session. Includes information about

| Name             | Description                                                                 | Type     | Notes                                           |
|------------------|-----------------------------------------------------------------------------|----------|-------------------------------------------------|
| session_id       | Unique identifier of the session.                                           | integer  | Automatically Generated by Datastore.           |
| session_name     | Human-readable session name.                                                |          |                                                 |
| type             | The type of session.                                                        | string   | Training or Testing session.                    |
| model_name       | Name of the model used in the session.                                      | string   |                                                 |
| session_start    | Time the session started.                                                   | datetime | Can be actual time or start of time of data set |
| session_end      | Time the session ended.                                                     | datetime | Can be actual time or end time of data set      |
| starting_balance | Balance in dollars at the start of the session.                             | float    |                                                 |
| ending_balance   | Balance in dollars at the end of the session.                               | float    |                                                 |
| starting_coins   | Number of coins at the start of the session.                                | float    |                                                 |
| ending_coins     | Number of coins at the end of the session.                                  | float    |                                                 |
| coins_sold       | Number of coins sold during the session.                                    | float    |                                                 |
| coins_bought     | Number of coins purchased during the session.                               | float    |                                                 |
| number_of_trades | Number of trades made in the session.                                       | integer  |                                                 |
| crypto_type      | The symbol that identifies the crypto currency being traded in the session. | string   | 'BTC' or 'BTCUSDT' for example.                 |

### Transactions

Entity describing a transaction that occurs during a trading session.

| Name                  | Description                                                   | Type     | Notes                                  |
|-----------------------|---------------------------------------------------------------|----------|----------------------------------------|
| transaction_id        | Unique identifier for the transaction.                        | integer  | Automatically generated by datastore.  |
| session_id            | The id of the session in which the transaction was generated. | integer  | Foreign key from SessionPage entity.   |
| type                  | Indicates a purchase or sale of crypto currency.              | string   | 'Purchase' or 'Sale' are valid values. |
| crypto_type           | The symbol that identifies the crypto currency.               | string   | 'BTC' or 'BTCUSDT' for example.        |
| amount                | The amount of crypto currency bought or sold.                 | float    |                                        |
| value                 | The value in USD of the crypto currency bought or sold.       | float    |                                        |
| transaction_date_time | The date and time the transaction occurred                    | datetime |                                        |

---

## Model_Info

### Get Info for Model

> GET '/crypto/training_data'

Not Implemented

### Get a Specific Data Set

> GET '/crypto/training_data/:data_label'

Not Implemented

### Create a new Data Set or Replace Existing

> POST '/crypto/training_data/:data_label'

Not Implemented

### Delete a Specific Data Set

> DELETE '/crypto/training_data/:data_label'

Not Implemented

---

## Sessions

### Get All Sessions

> GET /session

#### Example Response

```json
{
    "next": "",
    "total": 2,
    "sessions": [
        {
            "coins_bought": null,
            "coins_sold": null,
            "crypto_type": "test crypto",
            "ending_balance": null,
            "ending_coins": null,
            "id": 5631671361601536,
            "model_name": null,
            "number_of_trades": null,
            "self": "https://datastore-micro-dot-ai-ml-bitcoin-bot.uw.r.appspot.com/session/5631671361601536/transactions",
            "session_end": null,
            "session_name": "test session",
            "session_start": "02/13/2023, 21:07:52",
            "starting_balance": 1000.0,
            "starting_coins": 10.0,
            "type": "test type"
        },
        {
            "coins_bought": null,
            "coins_sold": null,
            "crypto_type": "BTCUSDT",
            "ending_balance": null,
            "ending_coins": null,
            "id": 5634161670881280,
            "model_name": null,
            "number_of_trades": null,
            "self": "https://datastore-micro-dot-ai-ml-bitcoin-bot.uw.r.appspot.com/session/5634161670881280/transactions",
            "session_end": null,
            "session_name": "test session",
            "session_start": "01/30/2023, 14:23:57",
            "starting_balance": 1000.0,
            "starting_coins": 0.0,
            "type": "training"
        }
    ]
}
```

### Create New Session

> POST /session

#### Header

| Name         | Value            | Required |
|--------------|------------------|----------|
| Content-Type | application/json | yes      |
| Accept       | application/json | yes      |

#### Example Request

```json
{
    "session_name": "test_session_name",
    "type": "test_session",
    "model_name": "test_model",
    "starting_balance": 1000.0,
    "starting_coins": 0.0,
    "crypto_type": "BTCUSDT"
}
```

#### Example Response

```json
{
    "coins_bought": null,
    "coins_sold": null,
    "crypto_type": "BTCUSDT",
    "ending_balance": null,
    "ending_coins": null,
    "id": 5702893864747008,
    "model_name": "test_model",
    "number_of_trades": null,
    "self": "https://datastore-micro-dot-ai-ml-bitcoin-bot.uw.r.appspot.com/session/5702893864747008",
    "session_end": null,
    "session_name": "test_session_name",
    "session_start": "02/15/2023, 18:59:09",
    "starting_balance": 1000.0,
    "starting_coins": 0.0,
    "type": "test_session"
}
```

### Get Session

> GET /session/:session_id

#### Example Response

```json
{
    "coins_bought": null,
    "coins_sold": null,
    "crypto_type": "BTCUSDT",
    "ending_balance": null,
    "ending_coins": null,
    "id": 5702893864747008,
    "model_name": "test_model",
    "number_of_trades": null,
    "self": "https://datastore-micro-dot-ai-ml-bitcoin-bot.uw.r.appspot.com/session/5702893864747008",
    "session_end": null,
    "session_name": "test_session_name",
    "session_start": "02/15/2023, 18:59:09",
    "starting_balance": 1000.0,
    "starting_coins": 0.0,
    "transaction_total": 0,
    "transaction_url": "https://datastore-micro-dot-ai-ml-bitcoin-bot.uw.r.appspot.com/session/5702893864747008/transactions",
    "type": "test_session"
}
```

### Edit Session

> PATCH /session/:session_id

#### Example Request

```json
{
    "ending_balance": 800.0,
    "ending_coins": 5.0,
    "coins_sold": 100,
    "coins_bought": 95,
    "number_of_trades": 1000
}
```

#### Example Response

```json
{
    "coins_bought": 95,
    "coins_sold": 100,
    "crypto_type": "BTCUSDT",
    "ending_balance": 800.0,
    "ending_coins": 5.0,
    "id": 5702893864747008,
    "model_name": "test_model",
    "number_of_trades": 1000,
    "self": "https://datastore-micro-dot-ai-ml-bitcoin-bot.uw.r.appspot.com/session/57028938647470085702893864747008",
    "session_end": null,
    "session_name": "test_session_name",
    "session_start": "02/15/2023, 18:59:09",
    "starting_balance": 1000.0,
    "starting_coins": 0.0,
    "type": "test_session"
}
```

### Delete Session

> DELETE /session/:session_id

#### Example Response

```json

```

---

## Transactions

### Get Transactions

> GET /session/:session_id/transaction

### Create Transaction

> POST /session/:session_id/transaction

### Get Transaction

> GET /session/:session_id/transaction/:transaction_id

### Edit Transaction

> PATCH /session/:session_id/transaction/:transaction_id

### Delete Transaction

> DELETE /session/:session_id/transaction/:transaction_id